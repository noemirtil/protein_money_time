{% extends "base.html" %}

{% block title %}
App name
{% endblock title %}

{% block content %}

{% if current_user.is_authenticated %}
<p>Hello, {{ current_user.username }}</p>
{% endif %}

<div class="space-between">
    {% block product_insert %}
    <form class="width-50" method="post" action="/product_insert">
        <!-- <h2 class="mensaje">{{ mensaje }}</h2> -->
        <label for="product_name">Product name: *</label>
        <input autocomplete="off" type="text" id="product_name" name="product_name"><br><br>
        <label for="brand_name">Brand name: *</label>
        <input autocomplete="off" type="text" id="brand_name" name="brand_name"><br><br>
        <label for="brand_website">Brand website: *</label>
        <input autocomplete="off" type="text" id="brand_website" name="brand_website"><br><br>
        <label for="product_url">Product link: *</label>
        <input autocomplete="off" type="text" id="product_name" name="product_name"
            value="https://www.google.com/"><br><br>
        <label for="product_ingredients">Ingredients list: *</label>
        <input autocomplete="off" type="text" id="product_ingredients" name="product_ingredients"><br><br>
        <label for="product_energy">Energy per 100g in kJ: *</label>
        <input autocomplete="off" type="text" id="product_energy" name="product_energy"><br><br>
        <label for="product_protein">Protein per 100g: *</label>
        <input autocomplete="off" type="text" id="product_protein" name="product_protein"><br><br>
        <label for="product_fat">Fat per 100g: *</label>
        <input autocomplete="off" type="text" id="product_fat" name="product_fat"><br><br>
        <label for="product_sat_fat">Saturated fat per 100g:</label>
        <input autocomplete="off" type="text" id="product_sat_fat" name="product_sat_fat"><br><br>
        <label for="product_carbs">Carbohydrates per 100g: *</label>
        <input autocomplete="off" type="text" id="product_carbs" name="product_carbs"><br><br>
        <label for="product_sugars">Sugars per 100g:</label>
        <input autocomplete="off" type="text" id="product_sugars" name="product_sugars"><br><br>
        <label for="product_fiber">Fiber per 100g:</label>
        <input autocomplete="off" type="text" id="product_fiber" name="product_fiber"><br><br>
        <label for="product_sodium">Sodium per 100g:</label>
        <input autocomplete="off" type="text" id="product_sodium" name="product_sodium"><br><br>
        <label for="product_c_vitamin">C Vitamin per 100g:</label>
        <input autocomplete="off" type="text" id="product_c_vitamin" name="product_c_vitamin"><br><br>
        <input type="submit" value="SAVE THIS NEW PRODUCT"
            class="bg-brand-orange hover:bg-orange-600 text-white px-4 py-2 rounded-md transition font-medium text-sm lg:text-base">
    </form>
    {% endblock product_insert %}

    {% block price_insert %}
    <form class="width-50" method="post" action="/price_insert">
        <!-- <h2 class="mensaje">{{ mensaje }}</h2> -->
        <label for="product_id">Search for a Product: *</label>
        <input autocomplete="off" type="text" id="product_id" name="product_id" value="last_saved"><br><br>
        <!-- Default to last saved product_id -->
        <!-- Message if product not found -->
        <label for="currency">Search for a Currency: *</label>
        <input autocomplete="off" type="text" id="currency" name="currency"><br><br>
        <label for="price">Price per package: *</label>
        <input autocomplete="off" type="number" id="price" name="price"><br><br>
        <label for="weight">Net weight in grams: *</label>
        <input autocomplete="off" type="number" id="weight" name="weight"><br><br>
        <!-- SELECTOR Weight OR Quantity -->
        <label for="quantity">Quantity in units per package: *</label>
        <input autocomplete="off" type="number" id="quantity" name="quantity"><br><br>
        <label for="store">Search for a Store: *</label>
        <input autocomplete="off" type="text" id="store" name="store"><br><br>
        <!-- Message if store not found -->
        <label for="website">Online store Website: *</label>
        <input autocomplete="off" type="text" id="website" name="website"><br><br>
        <!-- SELECTOR bought online OR address -->
        <label for="address">Physical store Address:</label>
        <input autocomplete="off" type="text" id="address" name="address"><br><br>
        <label for="country">Physical store country:</label>
        <input autocomplete="off" type="text" id="country" name="country"><br><br>
        <label for="comment">Comment:</label>
        <input autocomplete="off" type="text" id="comment" name="comment"><br><br>
        <input type="submit" value="SAVE THIS PRICE"
            class="bg-brand-orange hover:bg-orange-600 text-white px-4 py-2 rounded-md transition font-medium text-sm lg:text-base">
    </form>
    {% endblock price_insert %}
</div>

<br>
<div class="grid grid-cols-1 gap-4 sm:grid-cols-2 md:grid-cols-3">
    {% for product in products %}
    <div class="bg-white rounded-xl shadow-lg p-6 hover:shadow-xl transition-shadow duration-300">
        <!-- Product Name -->
        <h3 class="text-2xl font-extrabold text-gray-900 tracking-tight mb-2">
            <a href='{{ product["url"] }}'>{{ product["name"] }}
        </h3>
        <!-- Nutritionally relevant details -->
        <div class="text-sm text-gray-600 space-y-1">
            <div class="space-between">
                <div class="width-100">Brand: <span class="font-bold"><a href='{{ product["website"] }}'>{{
                            product["brand_name"]
                            }}</a></span></div>
                <form action="/edit" method="post">
                    <input name="edit" type="hidden" value="{{ product['id'] }}">
                    <button class="icons" type="submit">✏️</button>
                </form>
            </div>

            {% if product.price and product.currency_code %}
            <div class="space-between">
                <div>
                    Latest Price: <a href='{{ product["store_name"] }}'><span class="font-semibold">{{
                            product.currency_code
                            }} {{ product["price_per_kg"] }}</span></a> ({{
                    product.price_date.year }}-{{ product.price_date.month }}-{{ product.price_date.day
                    }})
                </div>
                <form action="/delete" method="post">
                    <input name="delete" type="hidden" value="{{ product['id'] }}">
                    <button class="icons" type="submit">❌</button>
                </form>
            </div>
            {% endif %}
        </div>
    </div>

    {% endfor %}
</div>

{% endblock content %}