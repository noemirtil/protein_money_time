{% extends "base.html" %}

{% block title %}
App name
{% endblock title %}

{% block content %}

{% if current_user.is_authenticated %}
<p>Hello, {{ current_user.username }}</p>
{% endif %}

<form class="product_insert" method="post" action="/product_insert">
    <!-- <h2 class="mensaje">{{ mensaje }}</h2> -->
    <label for="product_name">Product name: *</label>
    <input autocomplete="off" type="text" id="product_name" name="product_name"><br><br>
    <label for="product_url">Product link: *</label>
    <input autocomplete="off" type="text" id="product_name" name="product_name" value="https://www.google.com/"><br><br>
    <label for="product_name">Product name: *</label>
    <input autocomplete="off" type="text" id="product_name" name="product_name"><br><br>
    <label for="product_name">Product name: *</label>
    <input autocomplete="off" type="text" id="product_name" name="product_name"><br><br>
    <label for="product_name">Product name: *</label>
    <input autocomplete="off" type="text" id="product_name" name="product_name"><br><br>
    <label for="product_name">Product name: *</label>
    <input autocomplete="off" type="text" id="product_name" name="product_name"><br><br>
    <label for="product_name">Product name: *</label>
    <input autocomplete="off" type="text" id="product_name" name="product_name"><br><br>
    <label for="product_name">Product name: *</label>
    <input autocomplete="off" type="text" id="product_name" name="product_name"><br><br>
    <label for="product_name">Product name: *</label>
    <input autocomplete="off" type="text" id="product_name" name="product_name"><br><br>
    <label for="product_name">Product name: *</label>
    <input autocomplete="off" type="text" id="product_name" name="product_name"><br><br>
    <label for="product_name">Product name: *</label>
    <input autocomplete="off" type="text" id="product_name" name="product_name"><br><br>
    <label for="product_name">Product name: *</label>
    <input autocomplete="off" type="text" id="product_name" name="product_name"><br><br>
    <label for="product_name">Product name: *</label>
    <input autocomplete="off" type="text" id="product_name" name="product_name"><br><br>
    <label for="product_name">Product name: *</label>
    <input autocomplete="off" type="text" id="product_name" name="product_name"><br><br>
    <input type="submit" value="Enviar Solicitud">
</form>



"brand_id" INT REFERENCES "brands", -- can be null if it is a simple ingredient
"ingredients_text" TEXT NOT NULL, -- can be only one ingredient if it is a simple ingredient
"energy" SMALLINT NOT NULL CHECK ("energy" BETWEEN 0 AND 5000), -- for 100g
"fat" REAL NOT NULL CHECK ("fat" BETWEEN 0 AND 100), -- for 100g
"sat_fat" REAL CHECK ("sat_fat" BETWEEN 0 AND 100), -- for 100g
"carbs" REAL NOT NULL CHECK ("carbs" BETWEEN 0 AND 100), -- for 100g
"sugars" REAL CHECK ("sugars" BETWEEN 0 AND 100), -- for 100g
"fiber" REAL CHECK ("fiber" BETWEEN 0 AND 100), -- for 100g
"protein" REAL NOT NULL CHECK ("protein" BETWEEN 0 AND 100), -- for 100g
"sodium" REAL CHECK ("sodium" BETWEEN 0 AND 100), -- for 100g
"c_vitamin" REAL CHECK ("c_vitamin" BETWEEN 0 AND 100), -- for 100g
"nutr_score_fr" SMALLINT CHECK ("nutr_score_fr" BETWEEN -20 AND 50),




<div class="database">
    <h2 class="title">üìã Solicitudes Registradas</h2>
    <table>
        <tr>
            <th>ID</th>
            <th>Nombre</th>
            <th>Email</th>
            <th>Tel√©fono</th>
            <th>Direcci√≥n</th>
            <th>Perro preferido</th>
            <th>Editar</th>
            <th>Eliminar</th>
        </tr>
        {% if id_editar %}
        <tr class="edit_row">{% block editar %}{% endblock %}</tr>
        {% endif %}
        {% for resultado in resultados %}
        <tr>
            <td>{{ resultado["id"] }}</td>
            <td>{{ resultado["nombre"] }}</td>
            <td>{{ resultado["email"] }}</td>
            <td>{{ resultado["telefono"] }}</td>
            <td>{{ resultado["direccion"] }}</td>
            <td>{{ resultado["preferido"] }}</td>
            <td>
                <form action="/editar" method="post">
                    <input name="editar" type="hidden" value="{{ resultado['id'] }}">
                    <button class="icons" type="submit">‚úèÔ∏è</button>
                </form>
            </td>
            <td>
                <form action="/eliminar" method="post">
                    <input name="eliminar" type="hidden" value="{{ resultado['id'] }}">
                    <button class="icons" type="submit">‚ùå</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </table>
</div>




<div class="grid grid-cols-1 gap-4 sm:grid-cols-2 md:grid-cols-3">
    {% for product in products %}
    <div class="bg-white rounded-xl shadow-lg p-6 hover:shadow-xl transition-shadow duration-300">
        <!-- Product Name -->
        <h3 class="text-2xl font-extrabold text-gray-900 tracking-tight mb-2">
            {{ product.name.upper() }}
        </h3>

        <!-- Serving Size Header -->
        <hr class="bg-gray-900 h-px mb-2">
        <div class="flex flex-row justify-between text-base font-medium text-gray-700">
            <p>Serving size</p>
            <p>100g</p>
        </div>

        <!-- Thick Divider for Nutritional Section -->
        <hr class="bg-gray-900 h-3 my-4">

        <!-- Nutritional Information - Amount per serving -->
        <p class="text-xs font-medium text-gray-500 mb-2">Amount per serving (per 100g)</p>

        <!-- ENERGY (kj and kcal) -->
        <div class="grid grid-cols-2 items-baseline border-b border-gray-200 py-1">
            <p class="text-lg font-semibold text-gray-700">Energy</p>
            <p class="text-xl font-bold text-right text-gray-700">{{ product.energy }} kj</p>
            <!-- Kcal is placed on the next line in the second column -->
            <p class="col-span-2 text-xl font-bold text-right text-gray-700">{{ (product.energy * 0.239006) | round(0) |
                int }} kcal</p>
        </div>

        <!-- MACROS and MICROS -->
        {% if product.fat is not none %}
        <div class="flex justify-between border-b border-gray-200 py-1">
            <p class="text-base font-normal text-gray-700 ml-2">Fat</p>
            <p class="text-base font-semibold text-right text-gray-700">{{ product.fat | round(1) }} g</p>
        </div>
        {% endif %}

        {% if product.sat_fat is not none %}
        <div class="flex justify-between border-b border-gray-200 py-1 pl-4">
            <p class="text-sm font-light text-gray-600">‚Äî Saturated Fat</p>
            <p class="text-sm font-normal text-right text-gray-600">{{ product.sat_fat | round(1) }} g</p>
        </div>
        {% endif %}

        {% if product.carbs is not none %}
        <div class="flex justify-between border-b border-gray-200 py-1">
            <p class="text-base font-normal text-gray-700 ml-2">Carbohydrates</p>
            <p class="text-base font-semibold text-right text-gray-700">{{ product.carbs | round(1) }} g</p>
        </div>
        {% endif %}

        {% if product.sugars is not none %}
        <div class="flex justify-between border-b border-gray-200 py-1 pl-4">
            <p class="text-sm font-light text-gray-600">‚Äî Sugars</p>
            <p class="text-sm font-normal text-right text-gray-600">{{ product.sugars | round(1) }} g</p>
        </div>
        {% endif %}

        {% if product.fiber is not none %}
        <div class="flex justify-between border-b border-gray-200 py-1">
            <p class="text-base font-normal text-gray-700 ml-2">Fiber</p>
            <p class="text-base font-semibold text-right text-gray-700">{{ product.fiber | round(1) }} g</p>
        </div>
        {% endif %}

        {% if product.protein is not none %}
        <div class="flex justify-between border-b border-gray-200 py-1">
            <p class="text-base font-normal text-gray-700 ml-2">Protein</p>
            <p class="text-base font-semibold text-right text-gray-700">{{ product.protein | round(1) }} g</p>
        </div>
        {% endif %}

        {% if product.sodium is not none %}
        <div class="flex justify-between border-b border-gray-200 py-1">
            <p class="text-base font-normal text-gray-700 ml-2">Sodium</p>
            <p class="text-base font-semibold text-right text-gray-700">{{ product.sodium | round(0) | int }} mg</p>
        </div>
        {% endif %}

        {% if product.c_vitamin is not none %}
        <div class="flex justify-between py-1">
            <p class="text-base font-normal text-gray-700 ml-2">Vitamin C</p>
            <p class="text-base font-semibold text-right text-gray-700">{{ product.c_vitamin | round(0) | int }} mg</p>
        </div>
        {% endif %}

        <!-- Footer Divider -->
        <hr class="bg-gray-900 h-px mt-4 mb-2">

        <!-- Nutritionally relevant details -->
        <div class="text-sm text-gray-600 space-y-1">
            <p>Brand: <span class="font-bold">{{ product.brand_name }}</span></p>

            {% if product.nutr_score_fr %}
            <p>Nutri-Score: {{ product.nutr_score_fr }} <span
                    class="bg-{{ product.nutri_color }}-600 font-bold text-white rounded-lg p-1 text-center">{{
                    product.nutri_letter }} </span></p>
            {% endif %}

            {% if product.price and product.currency_code %}
            <p>Latest Price: <span class="font-semibold">{{ product.currency_code }} {{ product.price | round(2)
                    }}</span> ({{ product.price_date.year }}-{{ product.price_date.month }}-{{ product.price_date.day
                }})</p>
            {% endif %}

            {% if product.store_name %}
            <p>Last Seen At: <span class="font-semibold text-gray-800">{{ product.store_name }}</span></p>
            {% endif %}

            {% if product.ingredients_text %}
            <details class="pt-1">
                <summary class="cursor-pointer font-medium text-xs">Ingredients</summary>
                <p class="text-xs mt-1 italic max-h-16 overflow-y-auto">{{ product.ingredients_text }}</p>
            </details>
            {% endif %}
        </div>
    </div>

    {% endfor %}
</div>

{% endblock content %}